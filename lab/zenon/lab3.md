[На основну сторінку курсу](../../README.md)     [До списку лабораторних](../README.md)

# Лабораторна робота №3

**Тема. Змінні**

**Тривалість**: 4 акад. години (2 пари).

**Мета:** навчитися створювати змінні та типи даних 

**Цілі.** 

1. Добавити та налаштувати драйвер
2. Створити власні типи даних
3. Створити змінні

**Лабораторна установка**

- Апаратне забезпечення: ПК. 

- Програмне забезпечення: SCADA zenon.

## Порядок виконання роботи 

### 1. Налаштування драйверу

В цій лабораторній роботі ми перейдемо до  технічної сторони створення будь-якого проекту – організації зв’язку з  апаратними засобами. Для цього ми виберемо та сконфігуруємо  комунікаційний драйвер, а потім на його базі створимо декілька  змінних. 

Система керування отримує дані від обладнання  через драйвер. Він вибирається відповідно до мережевого протоколу чи  виробника PLC. В zenon інтегровано понад 300 різноманітних драйверів для підключення до найбільш розповсюдженого обладнання.

#### Завдання 3.1. Створення драйверу для зв'язку з ПЛК

Створіть та законфігуруйте драйвер для зв'язку з VIPA 300 по S7 TCP/IP.

- В менеджері проекту зайдіть в вузол *Variables* і виберіть пункт *Driver*

Як Ви бачите у вікні детального перегляду, тут вже є  декілька драйверів для створення внутрішніх, математичних та системних  змінних

- У вікні детального перегляду клікніть на іконці *New* *driver*

Автоматично відкриється вікно вибору драйверу.

![img](media3/1.png)

- Знайдіть папку *Vipa* і виберіть драйвер *S7 TCP-IP*
- Перейменуйте його на 'VIPA 300' і підтвердіть зроблений вибір кнопкою *OK*

*Перейменування драйверу може знадобитись тоді, коли Ви буде створювати мультитдайверну систему з багатьма контролерами.*

Тепер відкриється діалогове вікно конфігурування драйверу.

![img](media3/2.png)

- Переведіть *Mode* в *Simulation – static*

Якщо буде стояти режим *Hardware* після запуску  Runtime система відразу спробує з’єднатися з PLC. Оскільки у нас фізично його немає, то в проекті з’явиться помилка комунікації. Для нашого  прикладу ми будемо працювати в стимуляційному режимі. В інших закладках  налаштовуються комунікаційні параметри. Докладно про них можна знайти в  мануалі на відповідний драйвер. При роботі в режимі симуляції жодних  додаткових налаштувань робити не потрібно.

- Закінчіть конфігурування драйверу натиснувши кнопку *OK*

<iframe width="640" height="360" src="https://www.youtube.com/embed/R_XnzFzaVxw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

### 2. Типи даних

Усі змінні повинні відповідати конкретним типам даних згідно до стандартів  IEC. В zenon існує можливість використати існуючі типи або створити свій простий чи структурований тип даних.

В проекті ми будемо використовувати існуючі типи даних, а також структурований, який ми зараз і створимо.

#### Завдання 3.2 Створіть власних типів даних 

Створіть структурований тип даних "Танк" для з полями "Рівень", "Пуск/Стоп" та "Клапан".

- В менеджері проекту зайдіть в вузол *Variables* і виберіть пункт *Datatypes*
- У вікні детального перегляду клікніть на іконці *New* *structure* *datatype*

![img](media3/3.png)

- В якості імені нового структурованого типу задайте 'Танк'

Далі автоматично з’явиться вікно створення елементів структури

![img](media3/4.png)

- Задайте ім’я 'Рівень', і як базовий тип даних виберіть *USINT* 
- В полі опції повинно бути активно *Embedded*

*Якщо для елементу структури вибрано Embedded,  то властивості його типу даних можуть змінюватись незалежно від базового типу, наданого системою.*

- Кнопкою *Finish* закрийте це діалогове вікно

У вікні детального перегляду повинен з’явитись  створений нами структурований тип даних. Давайте додамо до нього ще  декілька елементів.

- Правою кнопкою мишки активуйте контекстне меню структурованого типу 'Танк' і виберіть пункт *New* *structure* *element*

Далі аналогічним чином додайте до структури елемент 'Пуск\Стоп': BOOL та 'Клапан': BOOL, Dim1=4.

<iframe width="640" height="360" src="https://www.youtube.com/embed/nHP-1gR0sIc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

### 3. Створення змінних

Процесні змінні являються з’єднуючою ланкою між джерелом даних (PLC, польова  шина…) та системою керування. В даному розділі ми створимо декілька  змінних, які базуються на простих та структурованих типах даних,  скориставшись при цьому поняттям масивів.

Багато драйверів системи керування дозволяють здійснювати прямий імпорт змінних з PLC-програми чи безпосередньо з самого контролера. Інформацію про можливість такого  імпорту можна знайти в мануалі на відповідний драйвер.

#### Завдання 3.3. Створення змінної-масиву 

Створіть змінну-масив "Температура" типу INT на 4 елементи.

- В менеджері проекту виберіть *Variables*
- У вікні детального перегляду клікніть на іконці *Variable* *new*

Автоматично відкриється вікно створення змінної

![img](media3/5.png)

- В якості імені задайте 'Температура'
- Драйвер *S7 TCP32 – VIPA 300*
- Об’єктний тип *Ext. Datablock*
- Тип даних виберіть *INT*

Оскільки ми будемо створювати масив змінних, нам необхідно зробити відповідні налаштування.

- В полі *Array settings* встановіть *Dim1* в 4
- Усі інші налаштування залиште як показано на малюнку вище

Після натиснення кнопки *Finish*, у вікні  детального перегляду з’явиться створена нами перша проста масивна  змінна, яка містить чотири змінні. Кожну з цих змінних можна налаштувати індивідуально.

Відповідно до встановлених налаштувань, система  керування автоматично виконала розподіл адрес для усіх змінних масиву.  Ми змінимо цю адресацію на свою власну.  

- У властивостях масивної змінної 'Температура' зайдіть в розділ *Addressing* і змініть початкове зміщення адрес *Start* *offset* на 11

![img](media3/6.png)

Таблиця адрес для елементів масиву тепер має наступний вигляд:

![img](media3/tab_zm1.png)

- В розділі *General* властивостей кожної змінної масиву в полі *Measuring* *unit* задайте одиницю виміру '°С'

Давайте виконаємо аналогічні дії, але вже з використанням структурованого типу даних.

<iframe width="640" height="360" src="https://www.youtube.com/embed/m0VBKVsQlXo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

#### Завдання 3.4. Створення структурованої змінної

 Створіть структуровану змінну-масив "Танк" типу "Танк" на 2 елементи

- В менеджері проекту виберіть *Variables*
- У вікні детального перегляду клікніть на іконці *Variable* *new*
- Введіть ім’я 'Танк'
- В якості драйверу виберіть *Intern* *–* *Driver for internal variables*
- Виберіть створений нами структурований тип 'Танк'
- Об’єктний тип *Internal variable*
- В полі *Array settings* встановіть *Dim1* в 2

Після натиснення кнопки *Finish*, система  запитає підтвердження на створення дванадцяти змінних. Таким чином,  автоматично буде створено структурну змінну, яка містить готовий набір  змінних для відображення параметрів двох танків.

Оскільки ми вибрали внутрішній драйвер, а не апаратний, то за розподілом адрес нам слідкувати не потрібно.

Там де необхідно, для змінних задайте одиниці вимірювання.

Ваш список змінних тепер повинен мати наступний вигляд:

![img](media3/tab_zm2.png)

На цьому, наше знайомство зі створенням змінних можна вважати завершеним.

<iframe width="640" height="360" src="https://www.youtube.com/embed/N7EgBMnIZGk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Порядок приймання роботи 

Здобувач надає звіт у форматі документу Word, у якому наводяться усі копії екранів та примітки до них  Викладач може перевірити вибірково демонстрацію виконання пунктів лабораторної роботи. 

## Питання до захисту 

1. Що таке база даних реального часу? 
2. Поясніть, що таке змінна SCADA? Що може бути джерелом даних для змінної?
3. Поясніть що таке відмітка часу і показник достовірності тегу?
4. Яку функція в SCADA zenon виконує драйвер? Який драйвер був використаний в лабораторній роботі, для зв'язку з якими засобами автоматизації він використовується?
5. Навіщо необхідно означувати типи даних для змінних? Розкажіть про використання типів даних в SCADA zenon.
6. Як створюються структуровані змінні в SCADA zenon?
7. Прокоментуйте призначення властивостей змінних, які змінювалися в лабораторній роботі.
